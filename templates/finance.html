{% extends "base.html" %}
{% block content %}
<h4>Finance</h4>

<form class="row g-2 mb-3" method="post" action="/add_transaction">
  <div class="col-md-2">
    <select class="form-select" name="type">
      <option value="credit">Credit</option>
      <option value="debit">Debit</option>
    </select>
  </div>
  <div class="col-md-3"><input class="form-control" name="category" placeholder="Category"></div>
  <div class="col-md-4"><input class="form-control" name="description" placeholder="Description"></div>
  <div class="col-md-2"><input class="form-control" name="amount" type="number" step="0.01" placeholder="Amount USD"></div>
  <div class="col-md-1"><button class="btn btn-success w-100">Add</button></div>
</form>

<h6>Monthly Summary</h6>
<div class="table-responsive">
<table class="table table-bordered">
  <thead><tr><th>Month</th><th>Total Credit</th><th>Total Debit</th><th>Balance</th></tr></thead>
  <tbody>
    {% for m in monthly %}
    <tr>
      <td>{{ m.month }}</td>
      <td>${{ '%.2f'|format(m.credit) }}</td>
      <td>${{ '%.2f'|format(m.debit) }}</td>
      <td><b>${{ '%.2f'|format(m.balance) }}</b></td>
    </tr>
    {% else %}<tr><td colspan="4" class="text-muted">No data</td></tr>{% endfor %}
  </tbody>
</table>
</div>

<h6 class="mt-4">Transactions (running balance)</h6>
<div class="table-responsive">
<table class="table table-striped table-bordered">
  <thead><tr><th>Date</th><th>Type</th><th>Category</th><th>Description</th><th>Amount</th><th>Balance</th></tr></thead>
  <tbody>
    {% for t in transactions %}
    <tr>
      <td>{{ t.date }}</td>
      <td class="{{ 'text-success' if t.type=='credit' else 'text-danger' }}">{{ t.type }}</td>
      <td>{{ t.category }}</td>
      <td>{{ t.description }}</td>
      <td>${{ '%.2f'|format(t.amount) }}</td>
      <td><b>${{ '%.2f'|format(t.balance) }}</b></td>
    </tr>
    {% else %}<tr><td colspan="6" class="text-muted">No transactions</td></tr>{% endfor %}
  </tbody>
</table>
</div>
{% endblock %}
