{% extends "base.html" %}
{% block content %}
<h3>Finance Overview</h3>

<form class="row g-2 mb-3" method="post" action="/add_transaction">
  <div class="col-md-2"><select name="type" class="form-select"><option value="credit">Credit</option><option value="debit">Debit</option></select></div>
  <div class="col-md-3"><input class="form-control" name="category" placeholder="Category (e.g. Shipping, Rent, Salary)"></div>
  <div class="col-md-3"><input class="form-control" name="description" placeholder="Description"></div>
  <div class="col-md-2"><input class="form-control" name="amount" placeholder="Amount USD"></div>
  <div class="col-md-2"><button class="btn btn-success w-100">Add</button></div>
</form>

<form class="row g-2 mb-3" method="get">
  <div class="col-md-3"><input type="month" name="month" class="form-control"></div>
  <div class="col-md-3"><select name="category" class="form-select"><option value="">All Categories</option>{% for cat in categories %}<option value="{{ cat }}">{{ cat }}</option>{% endfor %}</select></div>
  <div class="col-md-2"><button class="btn btn-primary w-100">Filter</button></div>
</form>

<h5>Monthly Summary</h5>
<table class="table table-striped table-bordered">
  <thead><tr><th>Month</th><th>Total Credit</th><th>Total Debit</th><th>Balance</th></tr></thead>
  <tbody>
    {% for m in monthly %}
    <tr><td>{{ m.month }}</td><td>${{ '%.2f'|format(m.credit) }}</td><td>${{ '%.2f'|format(m.debit) }}</td><td><b>${{ '%.2f'|format(m.balance) }}</b></td></tr>
    {% endfor %}
  </tbody>
</table>

<h5 class="mt-4">Transactions</h5>
<table class="table table-striped table-bordered">
  <thead><tr><th>Date</th><th>Type</th><th>Category</th><th>Description</th><th>Amount</th></tr></thead>
  <tbody>
  {% for t in transactions %}
  <tr>
    <td>{{ t.date }}</td>
    <td class="{{ 'text-success' if t.type=='credit' else 'text-danger' }}">{{ t.type }}</td>
    <td>{{ t.category }}</td>
    <td>{{ t.description }}</td>
    <td>${{ '%.2f'|format(t.amount) }}</td>
  </tr>
  {% endfor %}
  </tbody>
</table>
{% endblock %}
