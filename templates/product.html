{% extends "base.html" %}
{% block content %}
<h4>{{ product.name }} ({{ product.sku }})</h4>
<p>Cost CN: ${{ '%.2f'|format(product.cost_cn or 0.0) }} — Ship CN→KE: ${{ '%.2f'|format(product.ship_cn_ke or 0.0) }}</p>

<h6>Per-Country Stock / Spend / Profit</h6>
<div class="table-responsive">
<table class="table table-bordered">
  <thead><tr><th>Country</th><th>Stock</th><th>Ad Spend</th><th>Profit + Ads</th></tr></thead>
  <tbody>
    {% for r in country_rows %}
    <tr><td>{{ r.country }}</td><td>{{ r.stock }}</td><td>${{ '%.2f'|format(r.spend) }}</td><td>${{ '%.2f'|format(r.profit) }}</td></tr>
    {% endfor %}
  </tbody>
</table>
</div>

<h6>Shipments In Transit — China → Kenya</h6>
<div class="table-responsive">
<table class="table table-bordered">
  <thead><tr><th>Ref</th><th>Created</th><th>Qty</th><th>Cost</th><th>Status</th></tr></thead>
  <tbody>
    {% for sh in cnke %}
    <tr><td>{{ sh.ref }}</td><td>{{ sh.created_at.date() }}</td><td>{{ sh.items|map(attribute='qty')|sum }}</td><td>${{ '%.2f'|format(sh.shipping_cost_usd or 0.0) }}</td><td>{{ sh.status }}</td></tr>
    {% else %}<tr><td colspan="5" class="text-muted">None</td></tr>{% endfor %}
  </tbody>
</table>
</div>

<h6>Shipments In Transit — Between Countries</h6>
<div class="table-responsive">
<table class="table table-bordered">
  <thead><tr><th>Ref</th><th>From</th><th>To</th><th>Qty</th><th>Cost</th><th>Status</th></tr></thead>
  <tbody>
    {% for sh in inter %}
    <tr><td>{{ sh.ref }}</td><td>{{ sh.from_country }}</td><td>{{ sh.to_country }}</td><td>{{ sh.items|map(attribute='qty')|sum }}</td><td>${{ '%.2f'|format(sh.shipping_cost_usd or 0.0) }}</td><td>{{ sh.status }}</td></tr>
    {% else %}<tr><td colspan="6" class="text-muted">None</td></tr>{% endfor %}
  </tbody>
</table>
</div>
{% endblock %}
